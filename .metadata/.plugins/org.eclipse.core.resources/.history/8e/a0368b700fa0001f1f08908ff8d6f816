package com.example.demo;

import com.example.demo.BloodBank;
import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;
import jakarta.transaction.Transactional;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class BloodBankServices {

    @PersistenceContext
    private EntityManager entityManager;

    // Retrieve all blood banks
    public List<BloodBank> getAllBloodBanks() {
        return entityManager.createQuery("SELECT b FROM BloodBank b", BloodBank.class).getResultList();
    }

    // Find blood banks by city
    public List<BloodBank> findBloodBanksByCity(String city) {
        return entityManager.createQuery("SELECT b FROM BloodBank b WHERE b.city = :city", BloodBank.class)
                .setParameter("city", city)
                .getResultList();
    }

    // Save a new blood bank
    @Transactional
    public void saveBloodBank(BloodBank bloodBank) {
        entityManager.persist(bloodBank);
    }

    // Update a blood bank
    @Transactional
    public void updateBloodBank(BloodBank bloodBank) {
        entityManager.merge(bloodBank);
    }

    // Delete a blood bank
    @Transactional
    public void deleteBloodBank(BloodBank bloodBank) {
        entityManager.remove(entityManager.contains(bloodBank) ? bloodBank : entityManager.merge(bloodBank));
    }
}
